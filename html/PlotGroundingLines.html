
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>PlotGroundingLines</title><meta name="generator" content="MATLAB 9.1"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-06-08"><meta name="DC.source" content="PlotGroundingLines.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Plots grounding lines</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL,varargin)
</pre><h2 id="2">Plots grounding lines</h2><p>[xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL,varargin)</p><p>Examples:</p><pre class="language-matlab">PlotGroundingLines(CtrlVar,MUA,GF);
</pre><pre class="language-matlab">[xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,[],[],[],<span class="string">'r'</span>) <span class="comment">% plot GL in</span>
                                                                <span class="comment">% red</span>
</pre><pre class="language-matlab">GLgeo=[] ; xGL=[], yGL=[]; <span class="comment">% repeated use</span>
[xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL);
[xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL);
</pre><pre class="language-matlab">[xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL,<span class="string">'r'</span>,<span class="string">'LineWidth'</span>,2);
</pre><p>To plot grounding lines for higher-order elements with sub-element resolution set CtrlVar.GLsubdivide=1. Doing so causes higher-order elements to be split into sub-elements allowing for more accurate representation of the grounding line within an element.</p><p>To plot individual grounding lines in different colours set CtrlVar.PlotIndividualGLs=1</p><p>If xGL and yGL are empty on input, they are calculated from MUA and GLgeo.</p><p>If GLgeo, xGL and yGL are all empty on input, then GLgeo is first calculated from from GF and MUA, and then xGL and yGL are calculated from GLgeo.</p><p>If GLgeo, xGL and yGL are all empty, then MUA and GF can not be empty.</p><p>If xGL and yGL are not empty, then all other fields can be left empty.</p><p>varagin is passed on to plot</p><p>Note: If MUA and GF have not changed from a previous call to PlotGroundingLines, always give xGL and yGL from the previous call as inputs to all following calls as doing so saves time when plotting complicated grounding lines. In an initial call, where MUA and GF are available, do for example:</p><pre class="language-matlab">GLgeo=[] ; xGL=[] ; yGL=[];
[xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL); <span class="comment">% here GLgeo, xGL and yGL are all empty</span>
[xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL); <span class="comment">% here GLgeo, xGL and yGL are known from</span>
                                                                  <span class="comment">% the previous call (they will not be</span>
</pre><p>Hint: Once xGL and yGL have been calculated, for example through a previous call to PlotGroundingLines, one can also simply plot the grounding lines as: plot(xGL,yGL)</p><p>See also: PlotMuaBoundary</p><pre class="codeinput"><span class="keyword">if</span> isempty(CtrlVar)
    CtrlVar.XYscale=1;
    CtrlVar.PlotIndividualGLs=0;
    CtrlVar.PlotGLs=1;
<span class="keyword">end</span>

<span class="keyword">if</span> ~isfield(CtrlVar,<span class="string">'PlotXYscale'</span>) ; CtrlVar.PlotXYscale=1 ; <span class="keyword">end</span>
<span class="keyword">if</span> ~isfield(CtrlVar,<span class="string">'PlotGLs'</span>) ; CtrlVar.PlotGLs=1 ; <span class="keyword">end</span>
<span class="keyword">if</span> ~isfield(CtrlVar,<span class="string">'PlotIndividualGLs'</span>) ; CtrlVar.PlotIndividualGLs=0 ; <span class="keyword">end</span>


<span class="keyword">if</span> nargin&lt;4
    GLgeo=GLgeometry(MUA.connectivity,MUA.coordinates,GF,CtrlVar);
    xa=GLgeo(:,3) ;  xb=GLgeo(:,4) ; ya=GLgeo(:,5) ;  yb=GLgeo(:,6) ;
    [xGL,yGL]=LineUpEdges2([],xa,xb,ya,yb);

<span class="keyword">elseif</span> isempty(xGL) || isempty(yGL)

    <span class="keyword">if</span> isempty(GLgeo)

        <span class="keyword">if</span> isempty(GF)
            error(<span class="string">'On input GF can not be empty if xGL, yGL and GLgeo are as well. \n'</span>)
        <span class="keyword">else</span>
            GLgeo=GLgeometry(MUA.connectivity,MUA.coordinates,GF,CtrlVar);
        <span class="keyword">end</span>
    <span class="keyword">end</span>

    xa=GLgeo(:,3) ;  xb=GLgeo(:,4) ; ya=GLgeo(:,5) ;  yb=GLgeo(:,6) ;
    [xGL,yGL]=LineUpEdges2([],xa,xb,ya,yb);

<span class="keyword">end</span>

<span class="keyword">if</span> CtrlVar.PlotGLs &amp;&amp; ~CtrlVar.PlotIndividualGLs

    plot(xGL/CtrlVar.PlotXYscale,yGL/CtrlVar.PlotXYscale,varargin{:}) ;
    ax=gca; ax.DataAspectRatio=[1 1 1];

<span class="keyword">elseif</span> CtrlVar.PlotIndividualGLs

    i=0;
    I=find(isnan(xGL)) ;
    I=[1;I(:)];
    col=[<span class="string">'b'</span>,<span class="string">'r'</span>,<span class="string">'c'</span>,<span class="string">'g'</span>,<span class="string">'k'</span>,<span class="string">'m'</span>];
    <span class="comment">%col=['b','r'];</span>
    <span class="keyword">for</span> ii=1:numel(I)-1
        i=i+1;
        plot(xGL(I(ii):I(ii+1)),yGL(I(ii):I(ii+1)),col(i)) ; axis <span class="string">equal</span> ; hold <span class="string">on</span> ;
        <span class="keyword">if</span> i==numel(col) ; i=0 ; <span class="keyword">end</span>
    <span class="keyword">end</span>
    ax=gca; ax.DataAspectRatio=[1 1 1];
<span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016b</a><br></p></div><!--
##### SOURCE BEGIN #####
function [xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL,varargin)

%% Plots grounding lines
%
% [xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL,varargin)
%
% Examples:
%
%   
%   PlotGroundingLines(CtrlVar,MUA,GF);
%
%   [xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,[],[],[],'r') % plot GL in 
%                                                                   % red
%   
%
%   GLgeo=[] ; xGL=[], yGL=[]; % repeated use
%   [xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL);
%   [xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL);
%
%   [xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL,'r','LineWidth',2);
%
% To plot grounding lines for higher-order elements with sub-element resolution
% set CtrlVar.GLsubdivide=1. Doing so causes higher-order elements to be split
% into sub-elements allowing for more accurate representation of the grounding
% line within an element.
%
% To plot individual grounding lines in different colours set
% CtrlVar.PlotIndividualGLs=1
%
% If xGL and yGL are empty on input, they are calculated from MUA and GLgeo.
%
% If GLgeo, xGL and yGL are all empty on input, then GLgeo is first calculated
% from from GF and MUA, and then xGL and yGL are calculated from GLgeo.
%
% If GLgeo, xGL and yGL are all empty, then MUA and GF can not be empty.
%
% If xGL and yGL are not empty, then all other fields can be left empty.
%
% varagin is passed on to plot
%
% Note: If MUA and GF have not changed from a previous call to
% PlotGroundingLines, always give xGL and yGL from the previous call as inputs
% to all following calls as doing so saves time when plotting complicated
% grounding lines. In an initial call, where MUA and GF are available, do for
% example:
%  
%   GLgeo=[] ; xGL=[] ; yGL=[];
%   [xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL); % here GLgeo, xGL and yGL are all empty
%   [xGL,yGL,GLgeo]=PlotGroundingLines(CtrlVar,MUA,GF,GLgeo,xGL,yGL); % here GLgeo, xGL and yGL are known from
%                                                                     % the previous call (they will not be
%
% Hint: Once xGL and yGL have been calculated, for example through a previous call to
% PlotGroundingLines, one can also simply plot the grounding lines as:
% plot(xGL,yGL)
%
%
% See also: PlotMuaBoundary
%

if isempty(CtrlVar)
    CtrlVar.XYscale=1;
    CtrlVar.PlotIndividualGLs=0;
    CtrlVar.PlotGLs=1;
end

if ~isfield(CtrlVar,'PlotXYscale') ; CtrlVar.PlotXYscale=1 ; end
if ~isfield(CtrlVar,'PlotGLs') ; CtrlVar.PlotGLs=1 ; end
if ~isfield(CtrlVar,'PlotIndividualGLs') ; CtrlVar.PlotIndividualGLs=0 ; end


if nargin<4
    GLgeo=GLgeometry(MUA.connectivity,MUA.coordinates,GF,CtrlVar);
    xa=GLgeo(:,3) ;  xb=GLgeo(:,4) ; ya=GLgeo(:,5) ;  yb=GLgeo(:,6) ;
    [xGL,yGL]=LineUpEdges2([],xa,xb,ya,yb);
    
elseif isempty(xGL) || isempty(yGL)
    
    if isempty(GLgeo)
        
        if isempty(GF)
            error('On input GF can not be empty if xGL, yGL and GLgeo are as well. \n')
        else
            GLgeo=GLgeometry(MUA.connectivity,MUA.coordinates,GF,CtrlVar);
        end
    end
    
    xa=GLgeo(:,3) ;  xb=GLgeo(:,4) ; ya=GLgeo(:,5) ;  yb=GLgeo(:,6) ;
    [xGL,yGL]=LineUpEdges2([],xa,xb,ya,yb);
    
end

if CtrlVar.PlotGLs && ~CtrlVar.PlotIndividualGLs
    
    plot(xGL/CtrlVar.PlotXYscale,yGL/CtrlVar.PlotXYscale,varargin{:}) ;
    ax=gca; ax.DataAspectRatio=[1 1 1];
    
elseif CtrlVar.PlotIndividualGLs
    
    i=0;
    I=find(isnan(xGL)) ;
    I=[1;I(:)];
    col=['b','r','c','g','k','m'];
    %col=['b','r'];
    for ii=1:numel(I)-1
        i=i+1;
        plot(xGL(I(ii):I(ii+1)),yGL(I(ii):I(ii+1)),col(i)) ; axis equal ; hold on ;
        if i==numel(col) ; i=0 ; end
    end
    ax=gca; ax.DataAspectRatio=[1 1 1];
end




end
##### SOURCE END #####
--></body></html>